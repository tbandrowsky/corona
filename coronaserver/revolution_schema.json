{
  "schema_name": "Revolution",
  "schema_description": "Schema for the Revolution.",
  "schema_version": "1.0",
  "schema_authors": [
    "TJ Bandrowsky"
  ],
  "classes": [
    {
      "class_name": "note",
      "class_description": "a short note about something",
      "base_class_name": "sys_object",
      "parents": [ "sys_object" ],
      "fields": {
        "name": "string",
        "text": "string"
      }
    },
    {
      "class_name": "ticket",
      "class_description": "a short note about something",
      "base_class_name": "sys_object",
      "parents": [ "note" ],
      "fields": {
        "name": "string",
        "status": "string",
        "completion": "string"
      }
    },
    {
      "class_name": "intelligence_ticket",
      "class_description": "a short note about something",
      "base_class_name": "ticket",
      "fields": {
      }
    },
    {
      "class_name": "appointment",
      "class_description": "a short note about something",
      "base_class_name": "ticket",
      "parents": [ "note" ],
      "fields": {
        "name": "string",
        "start_time": "date_time",
        "end_time": "date_time",
        "street": "string",
        "city": "string",
        "state": "string",
        "zip": "zip"
      }
    },
    {
      "class_name": "work_team",
      "class_description": "a team with tickets",
      "base_class_name": "sys_team",
      "fields": {
        "tickets": "[ ticket ]"
      }
    },
    {
      "class_name": "property",
      "base_class_name": "sys_object",
      "class_description": "a thing owned by a user",
      "parents": [ "sys_user" ],
      "fields": {
        "property_name": "string"
      }
    },
    {
      "class_name": "building",
      "class_description": "something built on a spot",
      "base_class_name": "property",
      "parents": [ "location" ],
      "fields": {
        "latitude": "double",
        "longitude": "double",
        "elevation": "double",
        "building_code": "string",
        "construction_code": "string"
      }
    },
    {
      "class_name": "location",
      "class_description": "a place where something is",
      "base_class_name": "property",
      "parents": [ "inventory" ],
      "fields": {
        "street1": "string",
        "street2": "string",
        "city": "string",
        "state": "string",
        "zip": "string",
        "country": "string"
      }
    },
    {
      "class_name": "articles",
      "class_description": "a place where something is",
      "base_class_name": "sys_object",
      "parents": [ "work_team" ],
      "fields": {
        "name": "string",
        "description": "string"
      }
    },
    {
      "class_name": "candidate",
      "class_description": "Candidates running for public office",
      "base_class_name": "sys_object",
      "fields": {
        "candidate_id": "string",
        "full_name": "string",
        "political_party": "string",
        "election_year": "int64",
        "street1": "string",
        "street2": "string",
        "city": "string",
        "state": "string",
        "zip": "string",
        "committees": {
          "field_type": "query",
          "query": {
            "from": [
              {
                "class_name": "committee_candidate",
                "name": "committee_candidate",
                "filter": {
                  "candidate_id": "$this.candidate_id"
                }
              },
              {
                "class_name": "committee",
                "name": "committee",
                "filter": {
                  "committee_id": "committee_candidate.committee_id"
                }
              }
            ],
            "stages": [
              {
                "class_name": "filter",
                "stage_input_name": "committee"
              }
            ]
          }
        }
      },
      "indexes": {
        "candidate_candidate_id_idx": {
          "index_keys": [
            "candidate_id"
          ]
        },
        "candidate_full_name_idx": {
          "index_keys": [
            "full_name"
          ]
        }
      }
    },
    {
      "class_name": "candidate_search",
      "class_description": "search object for candidates",
      "base_class_name": "sys_object",
      "fields": {
        "full_name": "string",
        "state": "string",
        "city": "string",
        "political_party": "string",
        "candidates": {
          "field_type": "query",
          "query": {
            "from": [
              {
                "class_name": "candidate",
                "name": "candidate"
              }
            ],
            "stages": [
              {
                "class_name": "filter",
                "stage_input_name": "candidate",
                "condition": {
                  "class_name": "any",
                  "conditions": [
                    {
                      "class_name": "contains",
                      "valuepath": "full_name",
                      "value": "$this.full_name"
                    },
                    {
                      "class_name": "eq",
                      "valuepath": "state",
                      "value": "$this.state"
                    },
                    {
                      "class_name": "contains",
                      "valuepath": "city",
                      "value": "$this.city"
                    },
                    {
                      "class_name": "contains",
                      "valuepath": "political_party",
                      "value": "$this.political_party"
                    }
                  ]
                }
              }
            ]
          }
        }
      }
    },
    {
      "class_name": "committee",
      "class_description": "Political groups that accept money from the public to support candidates",
      "base_class_name": "sys_object",
      "fields": {
        "committee_id": "string",
        "committee_name": "string",
        "political_party": "string"
      },
      "indexes": {
        "committee_committee_id_idx": {
          "index_keys": [
            "committee_id"
          ]
        }
      }
    },
    {
      "class_name": "committee_search",
      "class_description": "search object for committees",
      "base_class_name": "sys_object",
      "fields": {
        "committee_name": "string",
        "political_party": "string",
        "committees": {
          "field_type": "query",
          "query": {
            "from": [
              {
                "class_name": "committee",
                "name": "committee",
                "filter": {
                  "committee_name": "$this.committee_name",
                  "political_party": "$this.political_party"
                }
              }
            ],
            "stages": [
              {
                "class_name": "filter",
                "stage_input_name": "committee",
                "condition": {
                  "class_name": "all",
                  "conditions": [
                    {
                      "class_name": "contains",
                      "valuepath": "committee_name",
                      "value": "$this.committee_name"
                    },
                    {
                      "class_name": "contains",
                      "valuepath": "political_party",
                      "value": "$this.political_party"
                    }
                  ]
                }
              }
            ]
          }
        }
      }
    },
    {
      "class_name": "committee_candidate",
      "class_description": "Mapping of committees and candidates",
      "base_class_name": "sys_object",
      "fields": {
        "committee_id": "string",
        "candidate_id": "string"
      },
      "indexes": {
        "committee_candidate_committee_id_idx": {
          "index_keys": [
            "committee_id"
          ]
        },
        "committee_candidate_candidate_id_idx": {
          "index_keys": [
            "candidate_id"
          ]
        }
      }
    },
    {
      "class_name": "individual",
      "class_description": "Mapping of committees and candidates",
      "base_class_name": "sys_object",
      "fields": {
        "committee_id": "string",
        "full_name": "string",
        "city": "string",
        "state": "string",
        "zip": "string",
        "employer": "string",
        "occupation": "string",
        "transaction_date": "datetime",
        "transaction_amount": "double",
        "memo": "string"
      }
    },
    {
      "class_name": "individual_search",
      "class_description": "Mapping of committees and candidates",
      "base_class_name": "sys_object",
      "fields": {
        "full_name": {
          "field_type": "string",
          "required": true
        },
        "city": {
          "field_type": "string",
          "required": true
        },
        "state": {
          "field_type": "string",
          "required": true
        },
        "employer": "string",
        "occupation": "string",
        "transaction_date": "datetime",
        "transaction_amount": "double",
        "memo": "string",
        "individuals": {
          "field_type": "query",
          "query": {
            "from": [
              {
                "class_name": "individual",
                "name": "individual",
                "filter": {
                  "city": "$this.city",
                  "state": "$this.state",
                  "zip": "$this.zip"
                }
              }
            ],
            "stages": [
              {
                "class_name": "filter",
                "stage_input_name": "individual",
                "condition": {
                  "class_name": "all",
                  "conditions": [
                    {
                      "class_name": "contains",
                      "valuepath": "full_name",
                      "value": "$this.full_name"
                    }
                  ]
                }
              }
            ]
          }
        }
      }
    },
    {
      "class_name": "intelligence_home",
      "class_description": "Home object for intelligence teams",
      "base_class_name": "sys_object",
      "fields": {
      }
    }
  ],
  "users": [

  ],
  "datasets": [
    {
      "dataset_name": "Revolution Teams",
      "dataset_description": "Teams and their default memberships",
      "dataset_version": "1.1",
      "dataset_author": "Todd Bandrowsky",
      "dataset_source": "This is canonical",
      "objects": [
        {
          "class_name": "work_team",
          "team_name": "intelligence_team",
          "team_description": "Gathers Information for the Revolution",
          "team_domain": ".*",
          "workflow_classes": [ "intelligence_home", "individual_search", "candidate_search", "comittee_search", "library_search" ],
          "permissions": [
            {
              "class_name": "sys_grant",
              "grant_class": "individual",
              "get": "any",
              "put": "any",
              "delete": "any",
              "alter": "none"
            },
            {
              "class_name": "sys_grant",
              "grant_class": "candidate",
              "get": "any",
              "put": "any",
              "delete": "any",
              "alter": "none"
            },
            {
              "class_name": "sys_grant",
              "grant_class": "committee",
              "get": "any",
              "put": "any",
              "delete": "any",
              "alter": "none"
            },
            {
              "class_name": "sys_grant",
              "grant_class": "committee",
              "get": "any",
              "put": "any",
              "delete": "any",
              "alter": "none"
            }
          ]
        },
        {
          "class_name": "work_team",
          "team_name": "Technicians",
          "team_description": "Revolution Technicians",
          "team_domain": "todd\\.bandrowsky@gmail\\.com",
          "workflow_classes": [ "developer_home", "individual_search", "candidate_search" ],
          "permissions": [
            {
              "class_name": "sys_grant",
              "grant_class": "sys_object",
              "get": "all",
              "put": "all",
              "delete": "all",
              "alter": "all"
            }
          ]
        }
      ]
    },
    {
      "dataset_name": "Candidate Master",
      "dataset_description": "Load Candidates",
      "dataset_version": "1.0",
      "dataset_author": "Federal Elections Commission",
      "dataset_source": "https://www.fec.gov/data/browse-data/?tab=bulk-data",
      "import": {
        "type": "csv",
        "delimiter": "|",
        "filename": "seed_data\\us_elections\\cn.csv",
        "target_class": "candidate",
        "column_map": {
          "0": "candidate_id",
          "1": "full_name",
          "2": "political_party",
          "3": "election_year",
          "10": "street1",
          "11": "street2",
          "12": "city",
          "13": "state",
          "14": "zip"
        }
      }
    },
    {
      "dataset_name": "Committee Master",
      "dataset_description": "Load Committees",
      "dataset_version": "1.0",
      "dataset_author": "Federal Elections Commission",
      "dataset_source": "https://www.fec.gov/data/browse-data/?tab=bulk-data",
      "import": {
        "type": "csv",
        "delimiter": "|",
        "filename": "seed_data\\us_elections\\cm.csv",
        "target_class": "committee",
        "column_map": {
          "0": "committee_id",
          "1": "committee_name",
          "10": "political_party",
          "13": "company_name"
        }
      }
    },
    {
      "dataset_name": "CommitteeCandidates Master",
      "dataset_description": "Map Committees and Candidates",
      "dataset_version": "1.0",
      "dataset_author": "Federal Elections Commission",
      "dataset_source": "https://www.fec.gov/data/browse-data/?tab=bulk-data",
      "import": {
        "type": "csv",
        "delimiter": "|",
        "filename": "seed_data\\us_elections\\ccl.csv",
        "target_class": "committee_candidate",
        "column_map": {
          "0": "candidate_id",
          "3": "committee_id"
        }
      }
    },
    {
      "dataset_name": "Individual Master",
      "dataset_description": "Load Individuals",
      "dataset_version": "1.0",
      "dataset_author": "Federal Elections Commission",
      "dataset_source": "https://www.fec.gov/data/browse-data/?tab=bulk-data",
      "import": {
        "type": "csv",
        "delimiter": "|",
        "filename": "seed_data\\us_elections\\itcont.csv",
        "target_class": "individual",
        "column_map": {
          "0": "committee_id",
          "7": "full_name",
          "8": "city",
          "9": "state",
          "10": "zip",
          "11": "employer",
          "12": "occupation",
          "13": "transaction_date",
          "14": "transaction_amount",
          "19": "memo"
        }
      }
    }

  ]
}