{
  "schema_name": "AzureSimple",
  "schema_description": "Simple Corona schema modeling Azure resources (resource groups, VMs, firewalls, storage, functions, DB servers) with richer child definitions and example dataset entries.",
  "schema_version": "1.1",
  "schema_authors": [
    "Generated by GitHub Copilot"
  ],
  "classes": [
    {
      "class_name": "azure_subscription",
      "base_class_name": "sys_object",
      "class_description": "Azure Subscription",
      "full_text": [ "display_name", "subscription_id", "tenant_id" ],
      "fields": {
        "subscription_id": "string",
        "display_name": "string",
        "tenant_id": "string",
        "owner_user": "string",
        "tags": "object",
        "resource_groups": "[ azure_resource_group ]"
      },
      "indexes": {
        "subscription_id_idx": { "index_keys": [ "subscription_id" ] }
      }
    },
    {
      "class_name": "azure_resource_group",
      "base_class_name": "sys_object",
      "class_description": "Resource Group (owned by a subscription)",
      "parents": [
        "azure_subscription"
      ],
      "fields": {
        "resource_group_name": "string",
        "subscription_id": "string",
        "region": "string",
        "owner_user": "string",
        "tags": "object",
        "virtual_machines": "[ azure_virtual_machine ]",
        "firewalls": "[ azure_firewall ]",
        "storages": "[ azure_storage_account]",
        "function_apps": "[ azure_function_app]",
        "database_servers": "[ azure_database_server]"
      },
      "indexes": {
        "rg_name_idx": { "index_keys": [ "resource_group_name", "subscription_id" ] }
      }
    },
    {
      "class_name": "azure_virtual_machine",
      "base_class_name": "sys_object",
      "class_description": "Virtual Machine instance",
      "parents": [
        "azure_resource_group"
      ],
      "fields": {
        "vm_name": "string",
        "resource_group": "azure_resource_group",
        "subscription_id": "string",
        "vm_size": "string",
        "os_type": "string",
        "os_version": "string",
        "private_ip": "string",
        "public_ip": "string",
        "vm_state": "string",
        "disks": "[ azure_disk ]",
        "nics": "[ azure_network_interface ]",
        "tags": "object"
      },
      "indexes": {
        "vm_name_idx": { "index_keys": [ "vm_name", "resource_group" ] }
      }
    },
    {
      "class_name": "azure_disk",
      "base_class_name": "sys_object",
      "class_description": "Disk attached to a VM",
      "parents": [
        "azure_virtual_machine"
      ],
      "fields": {
        "disk_name": "string",
        "size_gb": "int64",
        "sku": "string",
        "managed": "bool",
        "tags": "object"
      },
      "indexes": {
        "disk_name_idx": { "index_keys": [ "disk_name", "vm" ] }
      }
    },
    {
      "class_name": "azure_network_interface",
      "base_class_name": "sys_object",
      "class_description": "Network Interface attached to VM",
      "parents": [
        "azure_virtual_machine"
      ],
      "fields": {
        "nic_name": "string",
        "vm": "azure_virtual_machine",
        "private_ip": "string",
        "public_ip": "string",
        "subnet": "string",
        "tags": "object"
      },
      "indexes": {
        "nic_name_idx": { "index_keys": [ "nic_name", "vm" ] }
      }
    },
    {
      "class_name": "azure_firewall",
      "base_class_name": "sys_object",
      "class_description": "Firewall / Network Security resource",
      "parents": [
        "azure_resource_group"
      ],
      "fields": {
        "firewall_name": "string",
        "resource_group": "azure_resource_group",
        "subscription_id": "string",
        "sku": "string",
        "private_ip": "string",
        "public_ip": "string",
        "rules": "[ azure_firewall_rule ]",
        "tags": "object"
      },
      "indexes": {
        "firewall_name_idx": { "index_keys": [ "firewall_name", "resource_group" ] }
      }
    },
    {
      "class_name": "azure_firewall_rule",
      "base_class_name": "sys_object",
      "class_description": "Firewall rule",
      "parents": [
        "azure_firewall"
      ],
      "fields": {
        "rule_name": "string",
        "firewall": "azure_firewall",
        "priority": "int64",
        "action": "string",
        "source_addresses": "[ string ]",
        "destination_addresses": "[ string ]",
        "protocols": "[ string ]",
        "destination_ports": "[ string ]"
      },
      "indexes": {
        "fw_rule_idx": { "index_keys": [ "rule_name", "firewall" ] }
      }
    },
    {
      "class_name": "azure_storage_account",
      "base_class_name": "sys_object",
      "class_description": "Storage Account",
      "parents": [
        "azure_resource_group"
      ],
      "fields": {
        "account_name": "string",
        "resource_group": "azure_resource_group",
        "subscription_id": "string",
        "sku": "string",
        "kind": "string",
        "access_tier": "string",
        "containers": "[ azure_storage_container:storage_account = object_id ]",
        "tags": "object"
      },
      "indexes": {
        "storage_account_idx": { "index_keys": [ "account_name", "resource_group" ] }
      }
    },
    {
      "class_name": "azure_storage_container",
      "base_class_name": "sys_object",
      "class_description": "Storage container (blob) inside a storage account",
      "parents": [
        "azure_storage_account"
      ],
      "fields": {
        "container_name": "string",
        "storage_account": "azure_storage_account",
        "public_access": "string",
        "tags": "object"
      },
      "indexes": {
        "container_idx": { "index_keys": [ "container_name", "storage_account" ] }
      }
    },
    {
      "class_name": "azure_function_app",
      "base_class_name": "sys_object",
      "class_description": "Function App (serverless)",
      "parents": [
        "azure_resource_group"
      ],
      "fields": {
        "app_name": "string",
        "resource_group": "azure_resource_group",
        "subscription_id": "string",
        "runtime": "string",
        "runtime_version": "string",
        "triggers": "[ azure_function_trigger ]",
        "app_settings": "object",
        "tags": "object"
      },
      "indexes": {
        "function_app_idx": { "index_keys": [ "app_name", "resource_group" ] }
      }
    },
    {
      "class_name": "azure_function_trigger",
      "base_class_name": "sys_object",
      "class_description": "Function trigger definition",
      "parents": [
        "azure_function_app"
      ],
      "fields": {
        "trigger_name": "string",
        "app": "azure_function_app",
        "type": "string",
        "direction": "string",
        "auth_level": "string",
        "metadata": "object"
      },
      "indexes": {
        "function_trigger_idx": { "index_keys": [ "trigger_name", "app" ] }
      }
    },
    {
      "class_name": "azure_database_server",
      "base_class_name": "sys_object",
      "class_description": "Managed Database Server (MySQL/Postgres/SQLServer)",
      "parents": [
        "azure_resource_group"
      ],
      "fields": {
        "server_name": "string",
        "resource_group": "azure_resource_group",
        "subscription_id": "string",
        "engine": "string",
        "engine_version": "string",
        "fqdn": "string",
        "admin_user": "string",
        "databases": "[ azure_database ]",
        "tags": "object"
      },
      "indexes": {
        "db_server_idx": { "index_keys": [ "server_name", "resource_group" ] }
      }
    },
    {
      "class_name": "azure_database",
      "base_class_name": "sys_object",
      "class_description": "A database hosted on a database server",
      "parents": [
        "azure_database_server"
      ],
      "fields": {
        "database_name": "string",
        "server": "azure_database_server",
        "charset": "string",
        "collation": "string",
        "size_mb": "int64"
      },
      "indexes": {
        "database_idx": { "index_keys": [ "database_name", "server" ] }
      }
    }
  ],
  "users": [],
  "datasets": [
    {
      "dataset_name": "Azure Example",
      "dataset_description": "Example subscription with a resource group, VM, firewall, storage, function app and DB server.",
      "dataset_version": "1.0",
      "dataset_author": "Generated by GitHub Copilot",
      "objects": [
        {

        },
        {
          "class_name": "azure_subscription",
          "subscription_id": "sub-0001",
          "display_name": "Demo Subscription",
          "tenant_id": "tenant-0001",
          "owner_user": "demo@local",
          "tags": {
            "environment": "dev",
            "owner": "demo"
          },
          "resource_groups": [
            {
              "class_name": "azure_resource_group",
              "resource_group_name": "rg-demo-01",
              "subscription_id": "sub-0001",
              "region": "eastus",
              "owner_user": "demo@local",
              "tags": { "purpose": "demo" },
              "virtual_machines": [
                {
                  "class_name": "azure_virtual_machine",
                  "vm_name": "vm-demo-01",
                  "vm_size": "Standard_DS1_v2",
                  "os_type": "Linux",
                  "os_version": "Ubuntu 22.04",
                  "private_ip": "10.0.0.4",
                  "public_ip": "52.160.1.10",
                  "vm_state": "running",
                  "disks": [
                    {
                      "class_name": "azure_disk",
                      "disk_name": "vm-demo-01-osdisk",
                      "size_gb": 128,
                      "sku": "Premium_LRS",
                      "managed": true
                    }
                  ],
                  "nics": [
                    {
                      "class_name": "azure_network_interface",
                      "nic_name": "nic-vm-demo-01",
                      "private_ip": "10.0.0.4",
                      "public_ip": "52.160.1.10",
                      "subnet": "subnet-demo"
                    }
                  ],
                  "tags": { "role": "app" }
                }
              ],
              "firewalls": [
                {
                  "class_name": "azure_firewall",
                  "firewall_name": "fw-demo-01",
                  "sku": "AZFW_VNet",
                  "private_ip": "10.0.1.4",
                  "public_ip": "52.160.2.20",
                  "rules": [
                    {
                      "class_name": "azure_firewall_rule",
                      "rule_name": "allow-ssh",
                      "priority": 100,
                      "action": "allow",
                      "source_addresses": [ "0.0.0.0/0" ],
                      "destination_addresses": [ "10.0.0.4" ],
                      "protocols": [ "Tcp" ],
                      "destination_ports": [ "22" ]
                    }
                  ],
                  "tags": { "role": "perimeter" }
                }
              ],
              "storages": [
                {
                  "class_name": "azure_storage_account",
                  "account_name": "stgdemodemo",
                  "sku": "Standard_LRS",
                  "kind": "StorageV2",
                  "access_tier": "Hot",
                  "containers": [
                    {
                      "class_name": "azure_storage_container",
                      "container_name": "app-data",
                      "public_access": "None"
                    }
                  ],
                  "tags": { "purpose": "blobs" }
                }
              ],
              "function_apps": [
                {
                  "class_name": "azure_function_app",
                  "app_name": "fn-demo-01",
                  "runtime": "dotnet",
                  "runtime_version": "6.0",
                  "triggers": [
                    {
                      "class_name": "azure_function_trigger",
                      "trigger_name": "httpTrigger",
                      "type": "httpTrigger",
                      "direction": "in",
                      "auth_level": "function"
                    }
                  ],
                  "app_settings": { "WEBSITE_RUN_FROM_PACKAGE": "1" }
                }
              ],
              "database_servers": [
                {
                  "class_name": "azure_database_server",
                  "server_name": "db-demo-01",
                  "engine": "postgres",
                  "engine_version": "14",
                  "fqdn": "db-demo-01.postgres.database.azure.com",
                  "admin_user": "adminuser",
                  "databases": [
                    {
                      "class_name": "azure_database",
                      "database_name": "appdb",
                      "charset": "utf8",
                      "collation": "utf8_general_ci",
                      "size_mb": 2048
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    }
  ]
}